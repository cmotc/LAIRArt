#! /bin/sh
RETDIR=$(pwd)
justname(){
	RV=$(/usr/bin/basename "$1")
	echo -n "$RV"
}
fulldir(){
	TEMP=$(echo "$1" | /usr/bin/tr "/" "\n")
	TEMP2=""
	for p in $TEMP; do
	    RV="$TEMP2"
	    TEMP2="$TEMP2/$p"
	    if [ ! -d "$TEMP2" ]; then
	        break
	    fi
	done
	echo -n $RV
}
topdir(){
	TEMP=$(echo "$1" | /usr/bin/tr "/" "\n")
	TEMP2=""
	for p in $TEMP; do
	    TEMP2="$TEMP2/$p"
	    if [ ! -d "$TEMP2" ]; then
	        break
            else
	        RV="$p"
	    fi
	done
	echo -n $RV
}
ext(){
    if [ ! -d $1 ]; then
        RV=$(echo $1 | /usr/bin/awk -F . '{if (NF>1) {print $NF}}')
    else
        RV=$(topdir $1)
    fi
    echo $RV
}
top(){
    CAT=$(topdir "$1")
    PATH=$(fulldir "$1/$CAT")
    echo "<$CAT path=\"$PATH\">"
}
middle(){
    CAT=$(ext "$1")
    echo -n "<$CAT>"
    justname $1
    echo "</$CAT>"
}
bottom(){
    CAT=$(topdir "$1")
    echo -n "</" && echo "$CAT>"
}
if [ -d "$1" ]; then
	DIR="$1"
	cd "$DIR"
	WORKDIR=$(pwd)
	W=""
	X=""
	Y=""
	X=""
	top $WORKDIR
	for d in $WORKDIR/*; do
	    if [ -d $d ]; then
                echo -n "   " && top $d
		for e in $d/*; do
		    if [ -d $e ]; then
		        echo -n "      " && top $e
		        for f in $e/*; do
			    if [ -d $f ]; then
			        echo -n "         " && top $f
				for g in $f/*; do
				    echo -n "            " && middle $g
		                done
				echo -n "         " && bottom $f
			    else
			        echo -n "         " && middle $f
			    fi
		        done
			echo -n "      " && bottom $f
		    else
		        echo -n "      " && middle $e
		    fi
		done
		echo -n "   " && bottom $e
	    else
		echo -n "   " && middle $d
	    fi
	done
	echo -n "" && bottom $WORKDIR
fi
cd "$RETDIR"